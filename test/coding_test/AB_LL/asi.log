------------------------------------------------------------
          Invoking FHI-aims ...

          When using FHI-aims, please cite the following reference:

            Volker Blum, Ralf Gehrke, Felix Hanke, Paula Havu,
            Ville Havu, Xinguo Ren, Karsten Reuter, and Matthias Scheffler,
            'Ab Initio Molecular Simulations with Numeric Atom-Centered Orbitals',
            Computer Physics Communications 180, 2175-2196 (2009)

          In addition, many other developments in FHI-aims are likely important for
          your particular application. If so, please cite them. A partial list of references
          is written at the end of this file. Thank you for giving credit to the authors
          of these developments.

          For general information about FHI-aims please find us at

            https://fhi-aims.org

          Online tutorials can be found at

            https://fhi-aims-club.gitlab.io/tutorials/tutorials-overview/

          For any questions about FHI-aims, please visit our slack channel at

            https://fhi-aims.slack.com

          and our main development and support site at

            https://aims-git.rz-berlin.mpg.de .

          The latter site, in particular, has a wiki to collect information, as well
          as an issue tracker to log discussions, suggest improvements, and report issues
          or bugs. https://aims-git.rz-berlin.mpg.de is also the main development site
          of the project and all new and updated code versions can be obtained there.
          Please send an email to aims-coordinators@fhi-berlin.mpg.de and we will add
          you to these sites. They are for you and everyone is welcome there.

------------------------------------------------------------



  Date     :  20240501, Time     :  185902.943
  Time zero on CPU 1             :   0.107877200000000E+01  s.
  Internal wall clock time zero  :           483821942.943  s.

  FHI-aims created a unique identifier for this run for later identification
  aims_uuid : 233FB448-0E60-4D9F-AE02-A8080FFF99D0

  Build configuration of the current instance of FHI-aims
  -------------------------------------------------------
  FHI-aims version      : 240206
  Commit number         : b790bc0b9
  CMake host system     : Linux-6.2.15-100.fc36.x86_64
  CMake version         : 3.28.1
  Fortran compiler      : /opt/intel/oneapi/mpi/2021.11/bin/mpiifx (IntelLLVM) version 2024.0.2
  Fortran compiler flags:
  C compiler            : /opt/intel/oneapi/compiler/2024.0/bin/icx (IntelLLVM) version 2024.0.2
  C compiler flags      : -O3 -ip -fp-model precise -fPIC -std=gnu99
  C++ compiler          : /opt/intel/oneapi/compiler/2024.0/bin/icpx (IntelLLVM) version 2024.0.2
  C++ compiler flags    : -O3 -ip -fp-model precise
  HIP compiler          :
  HIP compiler flags    :
  HIP GPU arch          :
  Using MPI
  Using ScaLAPACK
  Using LibXC
  Using i-PI
  Using RLSY
  Linking against: /opt/intel/oneapi/mkl/2022.1.0/lib/intel64/libmkl_intel_lp64.so
                   /opt/intel/oneapi/mkl/2022.1.0/lib/intel64/libmkl_sequential.so
                   /opt/intel/oneapi/mkl/2022.1.0/lib/intel64/libmkl_core.so
                   /opt/intel/oneapi/mkl/2022.1.0/lib/intel64/libmkl_blacs_intelmpi_lp64.so
                   /opt/intel/oneapi/mkl/2022.1.0/lib/intel64/libmkl_scalapack_lp64.so

  Using        1 parallel tasks.
  Task        0 on host localhost.localdomain reporting.

  Memory overcommitment is allowed on your operating system.

  Obtaining array dimensions for all initial allocations:
  
  -----------------------------------------------------------------------
  Parsing control.in (first pass over file, find array dimensions only).
  The contents of control.in will be repeated verbatim below
  unless switched off by setting 'verbatim_writeout .false.' .
  in the first line of control.in .
  -----------------------------------------------------------------------
  
  #===============================================================================
  # FHI-aims file: ./control.in
  # Created using the Atomic Simulation Environment (ASE)
  # Wed May  1 18:59:02 2024
  #===============================================================================
  xc                                 pbe
  occupation_type                    gaussian 0.01
  mixer                              pulay
  n_max_pulay                        10
  charge_mix_param                   0.5
  sc_accuracy_rho                    1e-05
  sc_accuracy_eev                    0.001
  sc_accuracy_etot                   1e-06
  sc_iter_limit                      100
  collect_eigenvectors               .true.
  postprocess_anyway                 True
  density_update_method              density_matrix
  qm_embedding_calc                  1
  #===============================================================================
  
  ################################################################################
  #
  #  FHI-aims code project
  #  VB, Fritz-Haber Institut, 2009
  #
  #  Suggested "light" defaults for O atom (to be pasted into control.in file)
  #  Be sure to double-check any results obtained with these settings for post-processing,
  #  e.g., with the "tight" defaults and larger basis sets.
  #
  ################################################################################
    species        O
  #     global species definitions
      nucleus             8
      mass                15.9994
  #
      l_hartree           4
  #
      cut_pot             3.5  1.5  1.0
      basis_dep_cutoff    1e-4
  #
      radial_base         36 5.0
      radial_multiplier   1
       angular_grids specified
        division   0.2659   50
        division   0.4451  110
        division   0.6052  194
        division   0.7543  302
  #      division   0.8014  434
  #      division   0.8507  590
  #      division   0.8762  770
  #      division   0.9023  974
  #      division   1.2339 1202
  #      outer_grid 974
        outer_grid 302
  ################################################################################
  #
  #  Definition of "minimal" basis
  #
  ################################################################################
  #     valence basis states
      valence      2  s   2.
      valence      2  p   4.
  #     ion occupancy
      ion_occ      2  s   1.
      ion_occ      2  p   3.
  ################################################################################
  #
  #  Suggested additional basis functions. For production calculations,
  #  uncomment them one after another (the most important basis functions are
  #  listed first).
  #
  #  Constructed for dimers: 1.0 A, 1.208 A, 1.5 A, 2.0 A, 3.0 A
  #
  ################################################################################
  #  "First tier" - improvements: -699.05 meV to -159.38 meV
       hydro 2 p 1.8
       hydro 3 d 7.6
       hydro 3 s 6.4
  #  "Second tier" - improvements: -49.91 meV to -5.39 meV
  #     hydro 4 f 11.6
  #     hydro 3 p 6.2
  #     hydro 3 d 5.6
  #     hydro 5 g 17.6
  #     hydro 1 s 0.75
  #  "Third tier" - improvements: -2.83 meV to -0.50 meV
  #     ionic 2 p auto
  #     hydro 4 f 10.8
  #     hydro 4 d 4.7
  #     hydro 2 s 6.8
  #  "Fourth tier" - improvements: -0.40 meV to -0.12 meV
  #     hydro 3 p 5
  #     hydro 3 s 3.3
  #     hydro 5 g 15.6
  #     hydro 4 f 17.6
  #     hydro 4 d 14
  # Further basis functions - -0.08 meV and below
  #     hydro 3 s 2.1
  #     hydro 4 d 11.6
  #     hydro 3 p 16
  #     hydro 2 s 17.2
  ################################################################################
  #
  #  FHI-aims code project
  #  VB, Fritz-Haber Institut, 2009
  #
  #  Suggested "light" defaults for H atom (to be pasted into control.in file)
  #  Be sure to double-check any results obtained with these settings for post-processing,
  #  e.g., with the "tight" defaults and larger basis sets.
  #
  ################################################################################
    species        H
  #     global species definitions
      nucleus             1
      mass                1.00794
  #
      l_hartree           4
  #
      cut_pot             3.5  1.5  1.0
      basis_dep_cutoff    1e-4
  #
      radial_base         24 5.0
      radial_multiplier   1
      angular_grids       specified
        division   0.2421   50
        division   0.3822  110
        division   0.4799  194
        division   0.5341  302
  #      division   0.5626  434
  #      division   0.5922  590
  #      division   0.6542  770
  #      division   0.6868 1202
  #      outer_grid  770
        outer_grid  302
  ################################################################################
  #
  #  Definition of "minimal" basis
  #
  ################################################################################
  #     valence basis states
      valence      1  s   1.
  #     ion occupancy
      ion_occ      1  s   0.5
  ################################################################################
  #
  #  Suggested additional basis functions. For production calculations,
  #  uncomment them one after another (the most important basis functions are
  #  listed first).
  #
  #  Basis constructed for dimers: 0.5 A, 0.7 A, 1.0 A, 1.5 A, 2.5 A
  #
  ################################################################################
  #  "First tier" - improvements: -1014.90 meV to -62.69 meV
       hydro 2 s 2.1
       hydro 2 p 3.5
  #  "Second tier" - improvements: -12.89 meV to -1.83 meV
  #     hydro 1 s 0.85
  #     hydro 2 p 3.7
  #     hydro 2 s 1.2
  #     hydro 3 d 7
  #  "Third tier" - improvements: -0.25 meV to -0.12 meV
  #     hydro 4 f 11.2
  #     hydro 3 p 4.8
  #     hydro 4 d 9
  #     hydro 3 s 3.2
  ################################################################################
  #
  #  FHI-aims code project
  #  VB, Fritz-Haber Institut, 2009
  #
  #  Suggested "light" defaults for S atom (to be pasted into control.in file)
  #  Be sure to double-check any results obtained with these settings for post-processing,
  #  e.g., with the "tight" defaults and larger basis sets.
  #
  #  2020/09/08 Added f function to "light" after reinspection of Delta test outcomes.
  #             This was done for all of Al-Cl and is a tricky decision since it makes
  #             "light" calculations measurably more expensive for these elements.
  #             Nevertheless, outcomes for P, S, Cl (and to some extent, Si) appear
  #             to justify this choice.
  #
  ################################################################################
    species        S
  #     global species definitions
      nucleus             16
      mass                32.065
  #
      l_hartree           4
  #
      cut_pot             3.5          1.5  1.0
      basis_dep_cutoff    1e-4
  #
      radial_base         44 5.0
      radial_multiplier   1
      angular_grids       specified
        division   0.4665  110
        division   0.5810  194
        division   0.7139  302
  #      division   0.8274  434
  #      division   0.9105  590
  #      division   1.0975  770
  #      division   1.2028  974
  #      outer_grid  974
        outer_grid  302
  ################################################################################
  #
  #  Definition of "minimal" basis
  #
  ################################################################################
  #     valence basis states
      valence      3  s   2.
      valence      3  p   4.
  #     ion occupancy
      ion_occ      3  s   1.
      ion_occ      3  p   3.
  ################################################################################
  #
  #  Suggested additional basis functions. For production calculations,
  #  uncomment them one after another (the most important basis functions are
  #  listed first).
  #
  #  Constructed for dimers: 1.6 A, 1.9 A, 2.5 A, 3.25 A, 4.0 A
  #
  ################################################################################
  #  "First tier" - improvements: -652.81 meV to -45.53 meV
       ionic 3 d auto
       hydro 2 p 1.8
       hydro 4 f 7
       ionic 3 s auto
  #  "Second tier" - improvements: -30.20 meV to -1.74 meV
  #     hydro 4 d 6.2
  #     hydro 5 g 10.8
  #     hydro 4 p 4.9
  #     hydro 5 f 10
  #     hydro 1 s 0.8
  #  "Third tier" - improvements: -1.04 meV to -0.20 meV
  #     hydro 3 d 3.9
  #     hydro 3 d 2.7
  #     hydro 5 g 12
  #     hydro 4 p 10.4
  #     hydro 5 f 12.4
  #     hydro 2 s 1.9
  #  "Fourth tier" - improvements: -0.35 meV to -0.06 meV
  #     hydro 4 d 10.4
  #     hydro 4 p 7.2
  #     hydro 4 d 10
  #     hydro 5 g 19.2
  #     hydro 4 s 12
  
  
  -----------------------------------------------------------------------
  Completed first pass over input file control.in .
  -----------------------------------------------------------------------
  
  
  -----------------------------------------------------------------------
  Parsing geometry.in (first pass over file, find array dimensions only).
  The contents of geometry.in will be repeated verbatim below
  unless switched off by setting 'verbatim_writeout .false.' .
  in the first line of geometry.in .
  -----------------------------------------------------------------------
  
  #=======================================================
  # FHI-aims file: ./geometry.in
  # Created using the Atomic Simulation Environment (ASE)
  # Wed May  1 18:59:02 2024
  #=======================================================
  atom 0.0000000000000000 0.0000000000000000 0.1192620000000000 O
  qm_embedding_region 1
  atom 0.0000000000000000 0.7632390000000000 -0.4770470000000000 H
  qm_embedding_region 1
  atom 0.0000000000000000 -0.7632390000000000 -0.4770470000000000 H
  qm_embedding_region 1
  atom 0.0000000000000000 0.0000000000000000 2.6021350000000001 S
  qm_embedding_region 2
  atom 0.0000000000000000 0.9742690000000001 1.6829170000000000 H
  qm_embedding_region 2
  atom 0.0000000000000000 -0.9742690000000001 1.6829170000000000 H
  qm_embedding_region 2
  
  -----------------------------------------------------------------------
  Completed first pass over input file geometry.in .
  -----------------------------------------------------------------------
  

  Basic array size parameters:
  | Number of species                 :        3
  | Number of atoms                   :        6
  | Max. basis fn. angular momentum   :        3
  | Max. atomic/ionic basis occupied n:        3
  | Max. number of basis fn. types    :        3
  | Max. radial fns per species/type  :        5
  | Max. logarithmic grid size        :     1357
  | Max. radial integration grid size :       44
  | Max. angular integration grid size:      302
  | Max. angular grid division number :        8
  | Radial grid for Hartree potential :     1357
  | Number of spin channels           :        1
 QM_EMBEDDING WRITE IS  T
 QM_EMBEDDING WRITE IS  F

------------------------------------------------------------
          Reading file control.in.
------------------------------------------------------------
  XC: Using PBE gradient-corrected functionals.
  Occupation type: Gaussian broadening, width =   0.100000E-01 eV.
  Using pulay charge density mixing.
  Pulay mixing - number of memorized iterations:   10
  Charge density mixing - mixing parameter:     0.5000
  Convergence accuracy of self-consistent charge density:  0.1000E-04
  Convergence accuracy of sum of eigenvalues:  0.1000E-02
  Convergence accuracy of total energy:  0.1000E-05
  Maximum number of s.-c. iterations  :   100
  Postprocessing will be performed even if SCF does not converge.
 
  Reading configuration options for species O                   .
  | Found nuclear charge :   8.0000
  | Found atomic mass :    15.9994000000000      amu
  | Found l_max for Hartree potential  :   4
  | Found cutoff potl. onset [A], width [A], scale factor :    3.50000    1.50000    1.00000
  | Threshold for basis-dependent cutoff potential is   0.100000E-03
  | Found data for basic radial integration grid :    36 points, outermost radius =    5.000 A
  | Found multiplier for basic radial grid :   1
  | Found angular grid specification: user-specified.
  | Specified grid contains     5 separate shells.
  | Check grid settings after all constraints further below.
  | Found free-atom valence shell :  2 s   2.000
  | Found free-atom valence shell :  2 p   4.000
  | Found free-ion valence shell :  2 s   1.000
  | Found free-ion valence shell :  2 p   3.000
  | Found hydrogenic basis function :  2 p   1.800
  | Found hydrogenic basis function :  3 d   7.600
  | Found hydrogenic basis function :  3 s   6.400
 | Encountered keyword species, ending the description of species O                   .
  Species O                   : Missing cutoff potential type.
  Defaulting to exp(1/x)/(1-x)^2 type cutoff potential.
  Species O : No 'logarithmic' tag. Using default grid for free atom:
  | Default logarithmic grid data [bohr] : 0.1000E-03 0.1000E+03 0.1012E+01
  Species O : On-site basis accuracy parameter (for Gram-Schmidt orthonormalisation) not specified.
  Using default value basis_acc =  0.1000000E-03.
  Species O                   : Using default innermost maximum threshold i_radial=  2 for radial functions.
  Species O                   : Default cutoff onset for free atom density etc. : 0.35000000E+01 AA.
  Species O                   : Basic radial grid will be enhanced according to radial_multiplier =   1, to contain    36 grid points.
 
  Reading configuration options for species H                   .
  | Found nuclear charge :   1.0000
  | Found atomic mass :    1.00794000000000      amu
  | Found l_max for Hartree potential  :   4
  | Found cutoff potl. onset [A], width [A], scale factor :    3.50000    1.50000    1.00000
  | Threshold for basis-dependent cutoff potential is   0.100000E-03
  | Found data for basic radial integration grid :    24 points, outermost radius =    5.000 A
  | Found multiplier for basic radial grid :   1
  | Found angular grid specification: user-specified.
  | Specified grid contains     5 separate shells.
  | Check grid settings after all constraints further below.
  | Found free-atom valence shell :  1 s   1.000
  | Found free-ion valence shell :  1 s   0.500
  | Found hydrogenic basis function :  2 s   2.100
  | Found hydrogenic basis function :  2 p   3.500
 | Encountered keyword species, ending the description of species H                   .
  Species H                   : Missing cutoff potential type.
  Defaulting to exp(1/x)/(1-x)^2 type cutoff potential.
  Species H : No 'logarithmic' tag. Using default grid for free atom:
  | Default logarithmic grid data [bohr] : 0.1000E-03 0.1000E+03 0.1012E+01
  Species H : On-site basis accuracy parameter (for Gram-Schmidt orthonormalisation) not specified.
  Using default value basis_acc =  0.1000000E-03.
  Species H                   : Using default innermost maximum threshold i_radial=  2 for radial functions.
  Species H                   : Default cutoff onset for free atom density etc. : 0.35000000E+01 AA.
  Species H                   : Basic radial grid will be enhanced according to radial_multiplier =   1, to contain    24 grid points.
 
  Reading configuration options for species S                   .
  | Found nuclear charge :  16.0000
  | Found atomic mass :    32.0650000000000      amu
  | Found l_max for Hartree potential  :   4
  | Found cutoff potl. onset [A], width [A], scale factor :    3.50000    1.50000    1.00000
  | Threshold for basis-dependent cutoff potential is   0.100000E-03
  | Found data for basic radial integration grid :    44 points, outermost radius =    5.000 A
  | Found multiplier for basic radial grid :   1
  | Found angular grid specification: user-specified.
  | Specified grid contains     4 separate shells.
  | Check grid settings after all constraints further below.
  | Found free-atom valence shell :  3 s   2.000
  | Found free-atom valence shell :  3 p   4.000
  | Found free-ion valence shell :  3 s   1.000
  | Found free-ion valence shell :  3 p   3.000
  | Found ionic basis function :  3 d , default cutoff radius.
  | Found hydrogenic basis function :  2 p   1.800
  | Found hydrogenic basis function :  4 f   7.000
  | Found ionic basis function :  3 s , default cutoff radius.
  Species S                   : Missing cutoff potential type.
  Defaulting to exp(1/x)/(1-x)^2 type cutoff potential.
  Species S : No 'logarithmic' tag. Using default grid for free atom:
  | Default logarithmic grid data [bohr] : 0.1000E-03 0.1000E+03 0.1012E+01
  | Will include ionic basis functions of  2.0-fold positive S                    ion.
  Species S : On-site basis accuracy parameter (for Gram-Schmidt orthonormalisation) not specified.
  Using default value basis_acc =  0.1000000E-03.
  Species S                   : Using default innermost maximum threshold i_radial=  2 for radial functions.
  Species S                   : Default cutoff onset for free atom density etc. : 0.35000000E+01 AA.
  Species S                   : Basic radial grid will be enhanced according to radial_multiplier =   1, to contain    44 grid points.
 
  Finished reading input file 'control.in'.
 
------------------------------------------------------------


------------------------------------------------------------
          Reading geometry description geometry.in.
------------------------------------------------------------
  | The smallest distance between any two atoms is         0.96856502 AA.
  | The first atom of this pair is atom number                      1 .
  | The second atom of this pair is atom number                     2 .
  Input structure read successfully.
  The structure contains        6 atoms,  and a total of         28.000 electrons.

  Input geometry:
  | No unit cell requested.
  | Atomic structure:
  |       Atom                x [A]            y [A]            z [A]
  |    1: Species O             0.00000000        0.00000000        0.11926200
  |    2: Species H             0.00000000        0.76323900       -0.47704700
  |    3: Species H             0.00000000       -0.76323900       -0.47704700
  |    4: Species S             0.00000000        0.00000000        2.60213500
  |    5: Species H             0.00000000        0.97426900        1.68291700
  |    6: Species H             0.00000000       -0.97426900        1.68291700

  Slab Identifier: This is not a periodic structure.
 
  Finished reading input file 'geometry.in'.
 

 
  Consistency checks for stacksize environment parameter are next.
 
  | Maximum stacksize for task 0: unlimited
  | Current stacksize for task 0: unlimited
 
  Consistency checks for the contents of control.in are next.
 
  MPI_IN_PLACE appears to work with this MPI implementation.
  | Keeping use_mpi_in_place .true. (see manual).
  Target number of points in a grid batch is not set. Defaulting to  100
  Method for grid partitioning is not set. Defaulting to parallel hash+maxmin partitioning.
  Batch size limit is not set. Defaulting to    200
  By default, will store active basis functions for each batch.
  If in need of memory, prune_basis_once .false. can be used to disable this option.
  communication_type for Hartree potential was not specified.
  Defaulting to calc_hartree .
  Pulay mixer: Number of initial linear mixing iterations not set.
  Defaulting to    0 iterations.
  Work space size for distributed Hartree potential not set.
  Defaulting to   0.200000E+03 MB.
  Algorithm-dependent basis array size parameters:
  | n_max_pulay                         :       10
  Presetting      1001 iterations before the initial mixing cycle
  is restarted anyway using the sc_init_iter criterion / keyword.
  Presetting a factor      1.000 between actual scf density residual
  and density convergence criterion sc_accuracy_rho below which sc_init_iter
  takes no effect.
  Calculation of forces was not defined in control.in. No forces will be calculated.
  Geometry relaxation not requested: no relaxation will be performed.
  No accuracy limit for integral partition fn. given. Defaulting to  0.1000E-14.
  No threshold value for u(r) in integrations given. Defaulting to  0.1000E-05.
  No accuracy for occupation numbers given. Defaulting to  0.1000E-12.
  No threshold value for occupation numbers given. Defaulting to  0.0000E+00.
  No accuracy for fermi level given. Defaulting to  0.1000E-19.
  Maximum # of iterations to find E_F not set. Defaulting to  200.
  Preferred method for the eigenvalue solver ('KS_method') not specified in 'control.in'.
  Defaulting to serial version LAPACK (via ELSI).
  Will not use alltoall communication since running on < 1024 CPUs.
  Threshold for basis singularities not set.
  Default threshold for basis singularities:  0.1000E-04
  partition_type (choice of integration weights) for integrals was not specified.
  | Using a version of the partition function of Stratmann and coworkers ('stratmann_sparse').
  | At each grid point, the set of atoms used to build the partition table is smoothly restricted to
  | only those atoms whose free-atom density would be non-zero at that grid point.
  Partitioning for Hartree potential was not defined. Using partition_type for integrals.
  | Adjusted default value of keyword multip_moments_threshold to:       0.10000000E-11
  | This value may affect high angular momentum components of the Hartree potential in periodic systems.
  Spin handling was not defined in control.in. Defaulting to unpolarized case.
  No q(lm)/r^(l+1) cutoff set for long-range Hartree potential.
  | Using default value of  0.100000E-09 .
  | Verify using the multipole_threshold keyword.
  Defaulting to new monopole extrapolation.
  Density update method: density matrix based density update selected.
  Charge integration errors on the 3D integration grid will be compensated
  by explicit normalization and distribution of residual charges.
  Use the "compensate_multipole_errors" flag to change this behaviour.
 
  Consistency checks for the contents of geometry.in are next.
 
 * Warning! You did not set the 'relativistic' flag in input file 'control.in'.
 * FHI-aims will default to 'relativistic atomic_zora scalar'.
 * You must ensure that this is really what you want!!
 * For example, DO NOT compute total-energy differences between results from
 * different settings of the 'relativistic' flag.
  Number of empty states per atom not set in control.in - providing a guess from actual geometry.
  | Total number of empty states used during s.c.f. cycle:       12
  If you use a very high smearing, use empty_states (per atom!) in control.in to increase this value.

  Structure-dependent array size parameters: 
  | Maximum number of distinct radial functions  :       18
  | Maximum number of basis functions            :       59
  | Number of Kohn-Sham states (occupied + empty):       26
------------------------------------------------------------
  After read_input_data [GB]:      3.24

  Performing system and environment tests:
  *** Environment variable OMP_NUM_THREADS is not set
  *** For performance reasons you might want to set it to 1
  | Checking for ScaLAPACK...
  | Testing pdtran()...
  | All pdtran() tests passed.
  After prepare_system [GB]:      3.24

------------------------------------------------------------
          Preparing all fixed parts of the calculation.
------------------------------------------------------------
  Determining machine precision:
    2.225073858507201E-308
  Setting up grids for atomic and cluster calculations.

  Creating wave function, potential, and density for free atoms.
  Runtime choices for atomic solver:
  | atomic solver xc        : PBE
  | compute density gradient: 1
  | compute kinetic density : F

  Species: O

  List of occupied orbitals and eigenvalues:
    n    l              occ      energy [Ha]    energy [eV]
    1    0           2.0000       -18.926989      -515.0296
    2    0           2.0000        -0.880247       -23.9527
    2    1           4.0000        -0.331514        -9.0210


  Species: H

  List of occupied orbitals and eigenvalues:
    n    l              occ      energy [Ha]    energy [eV]
    1    0           1.0000        -0.237593        -6.4652


  Species: S

  List of occupied orbitals and eigenvalues:
    n    l              occ      energy [Ha]    energy [eV]
    1    0           2.0000       -88.678258     -2413.0582
    2    0           2.0000        -7.779365      -211.6873
    3    0           2.0000        -0.631865       -17.1939
    2    1           6.0000        -5.749610      -156.4549
    3    1           4.0000        -0.255301        -6.9471


  Adding cutoff potential to free-atom effective potential.
  Creating fixed part of basis set: Ionic, confined, hydrogenic.
 
  O                    hydrogenic:
 
  List of hydrogenic basis orbitals: 
    n    l      effective z      eigenvalue [eV]  inner max. [A]     outer max. [A]     outer radius [A]   
    2    1         1.800000       -10.9749           1.164242           1.164242           4.578029
    3    2         7.600000       -87.3180           0.624125           0.624125           3.251020
    3    0         6.400000       -61.9207           0.061167           1.081902           4.001998
 
 
  H                    hydrogenic:
 
  List of hydrogenic basis orbitals: 
    n    l      effective z      eigenvalue [eV]  inner max. [A]     outer max. [A]     outer radius [A]   
    2    0         2.100000       -14.9728           0.193243           1.317208           4.583499
    2    1         3.500000       -41.6669           0.602369           0.602369           3.723403
 
 
  S                    ion:

  List of free ionic orbitals and eigenvalues:
    n    l      energy [Ha]    energy [eV]
    1    0       -89.703778     -2440.9640
    2    0        -8.775428      -238.7916
    3    0        -1.470343       -40.0101
    2    1        -6.747660      -183.6132
    3    1        -1.048627       -28.5346


  List of ionic basis orbitals and eigenvalues:
    n    l      energy [Ha]    energy [eV]    outer radius [A]
    3    2        -0.495221       -13.4756       4.539062
    3    0        -1.470325       -40.0096       3.642502

 
  S                    hydrogenic:
 
  List of hydrogenic basis orbitals: 
    n    l      effective z      eigenvalue [eV]  inner max. [A]     outer max. [A]     outer radius [A]   
    2    1         1.800000       -10.9749           1.168531           1.168531           4.594893
    4    3         7.000000       -41.6658           1.212182           1.212182           4.539062
 
  Creating atomic-like basis functions for current effective potential.

  Species O                   :

  List of atomic basis orbitals and eigenvalues:
    n    l      energy [Ha]    energy [eV]    outer radius [A]
    1    0       -18.926989      -515.0296       1.415765
    2    0        -0.880247       -23.9527       4.413171
    2    1        -0.331514        -9.0210       4.522403


  Species H                   :

  List of atomic basis orbitals and eigenvalues:
    n    l      energy [Ha]    energy [eV]    outer radius [A]
    1    0        -0.237593        -6.4652       4.527807


  Species S                   :

  List of atomic basis orbitals and eigenvalues:
    n    l      energy [Ha]    energy [eV]    outer radius [A]
    1    0       -88.678258     -2413.0582       0.682391
    2    0        -7.779365      -211.6873       2.289014
    3    0        -0.631865       -17.1939       4.483910
    2    1        -5.749610      -156.4549       2.555240
    3    1        -0.255301        -6.9471       4.539062

  Assembling full basis from fixed parts.
  | Species O :   atomic orbital   1 s accepted.
  | Species O :    hydro orbital   3 s accepted.
  | Species O :   atomic orbital   2 s accepted.
  | Species O :   atomic orbital   2 p accepted.
  | Species O :    hydro orbital   2 p accepted.
  | Species O :    hydro orbital   3 d accepted.
  | Species H :   atomic orbital   1 s accepted.
  | Species H :    hydro orbital   2 s accepted.
  | Species H :    hydro orbital   2 p accepted.
  | Species S :   atomic orbital   1 s accepted.
  | Species S :   atomic orbital   2 s accepted.
  | Species S :    ionic orbital   3 s accepted.
  | Species S :   atomic orbital   3 s accepted.
  | Species S :   atomic orbital   2 p accepted.
  | Species S :   atomic orbital   3 p accepted.
  | Species S :    hydro orbital   2 p accepted.
  | Species S :    ionic orbital   3 d accepted.
  | Species S :    hydro orbital   4 f accepted.
 
  Basis size parameters after reduction:
  | Total number of radial functions:       18
  | Total number of basis functions :       59
 
  Per-task memory consumption for arrays in subroutine allocate_ext:
  |           6.255964MB.
  Testing on-site integration grid accuracy.
  |  Species  Function  <phi|h_atom|phi> (log., in eV)  <phi|h_atom|phi> (rad., in eV)
           1        1               -515.0295626295               -515.0294562738
           1        2                 15.1698434419                 15.1699322204
           1        3                -21.6038822678                -21.6039118105
           1        4                 -9.0211123393                 -9.0212703513
           1        5                  8.3047696391                  8.2854840999
           1        6                 45.8428042125                 45.8427461222
           2        7                 -6.4664147733                 -6.4652229287
           2        8                 13.7099062243                 13.7158503352
           2        9                 25.2661739479                 25.2663166526
           3       10              -2413.0581659109              -2413.0570554886
           3       11               -211.6872814127               -211.6872738937
           3       12                -16.9208611991                -16.9208255642
           3       13                  7.5845503345                  7.5614252779
           3       14               -156.4548540501               -156.4548540107
           3       15                 -6.9485729304                 -6.9508389945
           3       16                  7.5803076288                  7.5258504832 ***
           3       17                  6.1173006980                  6.1127563631
           3       18                 24.7512183535                 24.7503558869
 * Note: Onsite integrals marked "***" above are less accurate than
 * onsite_accuracy_threshold =    0.03000 eV. Usually, this is harmless.
 * When in doubt, tighten the "radial" and/or "radial_multiplier" flags to check.

  Preparing densities etc. for the partition functions (integrals / Hartree potential).

  Preparations completed.
  max(cpu_time)          :      0.241 s.
  Wall clock time (cpu1) :      0.170 s.
------------------------------------------------------------
  After prepare_scf [GB]:      3.21

  Initializing index lists of integration centers etc. from given atomic structure:
  | Number of centers in hartree potential         :         6
  | Number of centers in hartree multipole         :         6
  | Number of centers in electron density summation:         6
  | Number of centers in basis integrals           :         6
  | Number of centers in integrals                 :         6
  | Number of centers in hamiltonian               :         6
  After initialize_bc_dependent_lists [GB]:      3.21

  Initializing index lists of integration centers etc. from given atomic structure:
  | Number of centers in hartree potential         :         6
  | Number of centers in hartree multipole         :         6
  | Number of centers in electron density summation:         6
  | Number of centers in basis integrals           :         6
  | Number of centers in integrals                 :         6
  | Number of centers in hamiltonian               :         6

------------------------------------------------------------
          Begin self-consistency loop: Initialization.

          Date     :  20240501, Time     :  185903.132
------------------------------------------------------------
  Available memory per node after initialize_hartree_non_periodic_ewald [GB]:      3.21
  Available memory per node after initialize_recip_hartree_potential [GB]:      3.21
  Available memory per node after initialize_scalapack [GB]:      3.21
  Available memory per node after aims_elsi_init_scf [GB]:      3.21
  Available memory per node after initialize_fixed_grids [GB]:      3.21
  Partitioning the integration grid into batches with parallel hashing+maxmin method.
  | Number of batches:      507
  | Maximal batch size:     138
  | Minimal batch size:      62
  | Average batch size:      67.558
  | Standard deviation of batch sizes:       6.858

  Integration load balanced across     1 MPI tasks.
  Work distribution over tasks is as follows:
  Task     0 has      34252 integration points.
  Available memory per node after partition_grid [GB]:      3.21
  Initializing partition tables, free-atom densities, potentials, etc. across the integration grid (initialize_grid_storage).
  | initialize_grid_storage: Actual outermost partition radius vs. multipole_radius_free
  | (-- VB: in principle, multipole_radius_free should be larger, hence this output)
  | Species        1: Confinement radius =              5.000000000000001 AA, multipole_radius_free =              5.048384829883283 AA.
  | Species        1: outer_partition_radius set to              5.048384829883283 AA .
  | Species        2: Confinement radius =              5.000000000000001 AA, multipole_radius_free =              5.054417573612229 AA.
  | Species        2: outer_partition_radius set to              5.054417573612229 AA .
  | Species        3: Confinement radius =              5.000000000000001 AA, multipole_radius_free =              5.005414751018925 AA.
  | Species        3: outer_partition_radius set to              5.005414751018925 AA .
  | The sparse table of interatomic distances needs          0.39 kbyte instead of         0.29 kbyte of memory.
  | Using the partition_type stratmann_smoother will reduce your memory usage.
  | Net number of integration points:    34252
  | of which are non-zero points    :    30754
  Available memory per node after initialize_grid_storage_p1 [GB]:      3.22
  Renormalizing the initial density to the exact electron count on the 3D integration grid.
  | Initial density: Formal number of electrons (from input files) :      28.0000000000
  | Integrated number of electrons on 3D grid     :      27.9998111167
  | Charge integration error                      :      -0.0001888833
  | Normalization factor for density and gradient :       1.0000067459
  Renormalizing the free-atom superposition density to the exact electron count on the 3D integration grid.
  | Formal number of electrons (from input files) :      28.0000000000
  | Integrated number of electrons on 3D grid     :      27.9998111167
  | Charge integration error                      :      -0.0001888833
  | Normalization factor for density and gradient :       1.0000067459
  Obtaining max. number of non-zero basis functions in each batch (get_n_compute_maxes).
  | Maximal number of non-zero basis functions:       59 in task     0
  Available memory per node after get_n_compute_maxes_p1 [GB]:      3.22
  Allocating        0.012 MB for KS_eigenvector
  Available memory per node after allocate_matrices [GB]:      3.22
  Available memory per node after init_comm_sparse_local_matrix_scalapack [GB]:      3.22
  Integrating Hamiltonian matrix: batch-based integration.
  Time summed over all CPUs for integration: real work        0.089 s, elapsed        0.089 s
  Available memory per node after integrate hamiltonian matrix [GB]:      3.21
  Integrating overlap matrix.
  Time summed over all CPUs for integration: real work        0.034 s, elapsed        0.034 s
  Available memory per node after integrate ovlp matrix [GB]:      3.20
  Available memory per node after ASI_callbacks invoke [GB]:      3.20
  Available memory per node after save_overlap_scalapack [GB]:      3.20

  Updating Kohn-Sham eigenvalues and eigenvectors using ELSI and the (modified) LAPACK eigensolver.
  Overlap matrix is not singular
  | Lowest and highest eigenvalues :  0.7764E-02,  0.3986E+01
  Finished singularity check of overlap matrix
  | Time :     0.001 s
  Starting LAPACK eigensolver
  Finished Cholesky decomposition
  | Time :     0.000 s
  Finished transformation to standard eigenproblem
  | Time :     0.000 s
  Finished solving standard eigenproblem
  | Time :     0.000 s
  Finished back-transformation of eigenvectors
  | Time :     0.000 s

  Obtaining occupation numbers and electronic chemical potential using ELSI.
  | Note that, for insulating systems, the printed 'chemical potential' value is not uniquely defined.
  | It can be anywhere in the energy gap, as long as it correctly separates occupied and unoccupied states.
  | In systems with a gap, the physically relevant chemical potential is the VBM or HOMO.

  | Chemical potential (Fermi level):    -4.87135120 eV
  Available memory per node after advance_KS_solution [GB]:      3.20
  Writing Kohn-Sham eigenvalues.

  State    Occupation    Eigenvalue [Ha]    Eigenvalue [eV]
      1       2.00000         -88.705414        -2413.79713
      2       2.00000         -19.038867         -518.07393
      3       2.00000          -7.809961         -212.51986
      4       2.00000          -5.781061         -157.31066
      5       2.00000          -5.780693         -157.30067
      6       2.00000          -5.777657         -157.21805
      7       2.00000          -1.106250          -30.10260
      8       2.00000          -0.765414          -20.82797
      9       2.00000          -0.637705          -17.35282
     10       2.00000          -0.537477          -14.62549
     11       2.00000          -0.473459          -12.88347
     12       2.00000          -0.446283          -12.14398
     13       2.00000          -0.362555           -9.86563
     14       2.00000          -0.291932           -7.94387
     15       0.00000          -0.065200           -1.77417
     16       0.00000          -0.059564           -1.62083
     17       0.00000          -0.005404           -0.14705
     18       0.00000           0.026141            0.71132
     19       0.00000           0.149449            4.06671
     20       0.00000           0.150506            4.09547
     21       0.00000           0.160901            4.37834
     22       0.00000           0.172352            4.68994
     23       0.00000           0.174218            4.74072
     24       0.00000           0.233455            6.35264
     25       0.00000           0.268847            7.31571
     26       0.00000           0.342748            9.32664

  Highest occupied state (VBM) at     -7.94386788 eV
  | Occupation number:      2.00000000

  Lowest unoccupied state (CBM) at    -1.77417155 eV
  | Occupation number:      0.00000000

  Overall HOMO-LUMO gap:      6.16969633 eV.
  Calculating total energy contributions from superposition of free atom densities.

  Total energy components:
  | Sum of eigenvalues            :        -275.02945583 Ha       -7483.93227131 eV
  | XC energy correction          :         -35.27509057 Ha        -959.88405280 eV
  | XC potential correction       :          45.53216937 Ha        1238.99336782 eV
  | Free-atom electrostatic energy:        -212.72216695 Ha       -5788.46467664 eV
  | Hartree energy correction     :           0.00000000 Ha           0.00000000 eV
  | Entropy correction            :           0.00000000 Ha           0.00000000 eV
  | ---------------------------
  | Total energy                  :        -477.49454398 Ha      -12993.28763292 eV
  | Total energy, T -> 0          :        -477.49454398 Ha      -12993.28763292 eV  <-- do not rely on this value for anything but (periodic) metals
  | Electronic free energy        :        -477.49454398 Ha      -12993.28763292 eV

  Derived energy quantities:
  | Kinetic energy                :         477.95222400 Ha       13005.74174002 eV
  | Electrostatic energy          :        -920.17167741 Ha      -25039.14532015 eV
  | Energy correction for multipole
  | error in Hartree potential    :           0.00000000 Ha           0.00000000 eV
  | Sum of eigenvalues per atom                           :       -1247.32204522 eV
  | Total energy (T->0) per atom                          :       -2165.54793882 eV  <-- do not rely on this value for anything but (periodic) metals
  | Electronic free energy per atom                       :       -2165.54793882 eV
  Initialize hartree_potential_storage
  Max. number of atoms included in rho_multipole:            6

  End scf initialization - timings             :  max(cpu_time)    wall_clock(cpu1)
  | Time for scf. initialization                :        0.230 s           0.231 s
  | Boundary condition initialization           :        0.000 s           0.000 s
  | Integration                                 :        0.123 s           0.124 s
  | Solution of K.-S. eqns.                     :        0.001 s           0.001 s
  | Grid partitioning                           :        0.036 s           0.036 s
  | Preloading free-atom quantities on grid     :        0.045 s           0.044 s
  | Free-atom superposition energy              :        0.024 s           0.024 s
  | Total energy evaluation                     :        0.000 s           0.001 s

  Partial memory accounting:
  | Current value for overall tracked memory usage:
  |   Minimum:        0.039 MB (on task 0)
  |   Maximum:        0.039 MB (on task 0)
  |   Average:        0.039 MB
  | Peak value for overall tracked memory usage:
  |   Minimum:        1.177 MB (on task 0 after allocating grid_partition)
  |   Maximum:        1.177 MB (on task 0 after allocating grid_partition)
  |   Average:        1.177 MB
  | Largest tracked array allocation so far:
  |   Minimum:        0.784 MB (all_coords on task 0)
  |   Maximum:        0.784 MB (all_coords on task 0)
  |   Average:        0.784 MB
  Note:  These values currently only include a subset of arrays which are explicitly tracked.
  The "true" memory usage will be greater.
------------------------------------------------------------
  Available memory after allocating mixing [GB]:      3.18
  Evaluating new KS density using the density matrix
  Evaluating density matrix
